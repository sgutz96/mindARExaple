<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MindAR MVP</title>

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.160/build/three.min.js"></script>

<!-- MindAR -->
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js"></script>

<style>
  body {
    margin: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: black;
  }

  #ar-container {
    width: 100vw;
    height: 100vh;
    position: relative;
  }

  /* Panel informativo overlay */
  #info-panel {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    display: none;
  }

  #start-btn {
    position: absolute;
    top: 20px;
    left: 20px;
    padding: 10px 16px;
    background: #7c3aed;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    z-index: 10;
  }
</style>
</head>

<body>

<button id="start-btn">Iniciar AR</button>
<div id="ar-container"></div>
<div id="info-panel">üéØ Marcador detectado</div>

<script type="module">
const startBtn = document.querySelector("#start-btn");
const infoPanel = document.querySelector("#info-panel");

let mindarThree;
let cube;

startBtn.addEventListener("click", async () => {

  startBtn.style.display = "none";

  // 1Ô∏è‚É£ Inicializar MindAR
  const mindarThree = new window.MindARThree({
    container: document.querySelector("#ar-container"),
    imageTargetSrc: "./targets.mind",
  });


  const { renderer, scene, camera } = mindarThree;

  // 2Ô∏è‚É£ Luz
  const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1);
  scene.add(light);

  // 3Ô∏è‚É£ Crear objeto 3D
  const geometry = new THREE.BoxGeometry(0.1, 0.1, 0.1);
  const material = new THREE.MeshStandardMaterial({ color: 0x7c3aed });
  cube = new THREE.Mesh(geometry, material);

  // 4Ô∏è‚É£ Anchor al marcador 0
  const anchor = mindarThree.addAnchor(0);
  anchor.group.add(cube);

  // 5Ô∏è‚É£ Eventos del marcador
  anchor.onTargetFound = () => {
    console.log("Marcador detectado");
    infoPanel.style.display = "block";
  };

  anchor.onTargetLost = () => {
    console.log("Marcador perdido");
    infoPanel.style.display = "none";
  };

  // 6Ô∏è‚É£ Interacci√≥n b√°sica (click)
  window.addEventListener("click", () => {
    if (cube) {
      cube.scale.set(1.3,1.3,1.3);
      setTimeout(() => cube.scale.set(1,1,1), 200);
    }
  });

  // 7Ô∏è‚É£ Loop de animaci√≥n
  renderer.setAnimationLoop(() => {
    cube.rotation.y += 0.01;
    renderer.render(scene, camera);
  });

  // 8Ô∏è‚É£ Iniciar c√°mara
  await mindarThree.start();
});
</script>

</body>
</html>